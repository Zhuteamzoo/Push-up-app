
#This added lines between the dots and made it only the right side of the body
#Use python 3.10 for this 
#If getting version bugs then use this:
#cd "C:\Users\teren\OneDrive\Desktop\Python\ YOUR FILE HERE"
#py -3.10 -m venv mp_env
#mp_env\Scripts\activate
#now you should be in python 3.10 


#Good push up form:
#1.Body is a straight line ideal angle is ~170-180
#2.Elbow angle: top position ~180 down position ~90
#3.Wrist almost under shoulders
#4.Neck should be in good position(head)
#5.Elbows angles close to body

import cv2
import mediapipe as mp

cam = cv2.VideoCapture(0)

# Optional: lower resolution to make things smoother
cam.set(cv2.CAP_PROP_FRAME_WIDTH, 640)
cam.set(cv2.CAP_PROP_FRAME_HEIGHT, 480)

mp_pose = mp.solutions.pose
pose = mp_pose.Pose(
    model_complexity=1,          # you can set to 0 for faster, 2 for more accurate
    smooth_landmarks=True,
    min_detection_confidence=0.5,
    min_tracking_confidence=0.5
)

def to_xy_safe(lm, frame_w, frame_h, min_vis=0.5):
    """
    Convert a landmark to pixel coords if visibility is good.
    Returns (x, y) or None if not reliable.
    """
    if lm.visibility < min_vis:
        return None
    x = int(lm.x * frame_w)
    y = int(lm.y * frame_h)
    return (x, y)

while True:
    ret, frame = cam.read()
    if not ret:
        break

    frame = cv2.flip(frame, 1)
    rgb_frame = cv2.cvtColor(frame, cv2.COLOR_BGR2RGB)
    output = pose.process(rgb_frame)
    frame_h, frame_w, _ = frame.shape

    if output.pose_landmarks:
        lm_list = output.pose_landmarks.landmark  # list of 33 landmarks

        # ---- pick RIGHT SIDE joints ----
        # right side in MediaPipe: 12,14,16,24,26,28
        nose          = lm_list[0]   # for head reference
        r_shoulder    = lm_list[12]
        r_elbow       = lm_list[14]
        r_wrist       = lm_list[16]
        r_hip         = lm_list[24]
        r_knee        = lm_list[26]
        r_ankle       = lm_list[28]

        # ---- convert to pixel coords with visibility check ----
        nose_xy       = to_xy_safe(nose,       frame_w, frame_h)
        sh_xy         = to_xy_safe(r_shoulder, frame_w, frame_h)
        el_xy         = to_xy_safe(r_elbow,    frame_w, frame_h)
        wr_xy         = to_xy_safe(r_wrist,    frame_w, frame_h)
        hip_xy        = to_xy_safe(r_hip,      frame_w, frame_h)
        knee_xy       = to_xy_safe(r_knee,     frame_w, frame_h)
        ankle_xy      = to_xy_safe(r_ankle,    frame_w, frame_h)

        # ---- draw dots (only if visible) ----
        points = [nose_xy, sh_xy, el_xy, wr_xy, hip_xy, knee_xy, ankle_xy]
        for p in points:
            if p is None:
                continue
            cv2.circle(frame, p, 4, (0, 255, 0), -1)

        # ---- helper to draw a line only if both ends exist ----
        def draw_seg(p1, p2):
            if p1 is None or p2 is None:
                return
            cv2.line(frame, p1, p2, (0, 255, 0), 3)

        # ---- draw skeleton for right side ----
        draw_seg(nose_xy, sh_xy)      # head -> shoulder
        draw_seg(sh_xy, el_xy)        # shoulder -> elbow
        draw_seg(el_xy, wr_xy)        # elbow -> wrist
        draw_seg(sh_xy, hip_xy)       # shoulder -> hip
        draw_seg(hip_xy, knee_xy)     # hip -> knee
        draw_seg(knee_xy, ankle_xy)   # knee -> ankle

    cv2.imshow("Push-up Form - Right Side View", frame)

    if cv2.waitKey(1) & 0xFF == ord("q"):
        break

cam.release()
cv2.destroyAllWindows()
